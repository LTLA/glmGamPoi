---
title: "glmGamPoi Quickstart"
author: Constantin Ahlmann-Eltze
date: "`r Sys.Date()`"
output: BiocStyle::html_document
vignette: >
  %\VignetteIndexEntry{README-vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-"
)
```


> Fit Gamma-Poisson Generalized Linear Models Reliably.

The core design aims of `gmlGamPoi` are:

* Fit the Gamma-Poisson models on arbitrarily large or small datasets
* Be faster than alternative methods, such as `DESeq2` or `edgeR`
* Calculate exact or approximate results based on user preference
* Support in memory or on-disk data
* Follow established conventions around tools for RNA-seq analysis
* Present a simple user-interface
* Avoid unnecessary dependencies
* Make integration into other tools easy


# Installation

You can install the development version of `glmGamPoi` from [Github](https://github.com/const-ae/glmGamPoi):

``` r
# install.packages("devtools")
devtools::install_github("const-ae/glmGamPoi")
```

Please make sure that you are using at least R `3.6` and
BioConductor `3.10`.


# Example

To fit a single Gamma-Poisson GLM do:

```{r}
# overdispersion = 1/size
counts <- rnbinom(n = 10, mu = 5, size = 1/0.7)
# size_factors = FALSE, because only a single GLM is fitted
fit <- glmGamPoi::glm_gp(counts, design = ~ 1, size_factors = FALSE)
fit

# Internally fit is just a list:
c(fit)
```

The `glm_gp()` function returns a list with the results of the fit. Most importantly, it contains the estimates for the coefficients Î² and the overdispersion.

Fitting repeated Gamma-Poisson GLMs for each gene of a single cell dataset is just as easy:

I create an artifical dataset with 300 genes and 50 cells:

```{r}
# overdispersion = 1/size
count_matrix <- matrix(rnbinom(n = 300 * 50, mu = 5, size = 1/0.7), nrow = 300, ncol = 50)
# size_factors = FALSE, because only a single GLM is fitted
fit <- glmGamPoi::glm_gp(count_matrix, design = ~ 1)

summary(fit)
```


*Note: I present here only a small example due to the runtime limitations of R vignettes. For a full example on the `TENxPBMCData("pbmc4k")` dataset and a benchmark comparison with `edgeR` and `DESeq2` see the README on [GitHub](https://github.com/const-ae/glmGamPoi).*


# Session Info

```{r}
sessionInfo()
```


